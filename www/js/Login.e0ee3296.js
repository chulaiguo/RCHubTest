(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Login"],{"28a5":function(e,t,a){a("214f")("split",2,function(e,t,r){"use strict";var s=a("aae3"),i=r,o=[].push,n="split",p="length",d="lastIndex";if("c"=="abbc"[n](/(b)*/)[1]||4!="test"[n](/(?:)/,-1)[p]||2!="ab"[n](/(?:ab)*/)[p]||4!="."[n](/(.?)(.?)/)[p]||"."[n](/()()/)[p]>1||""[n](/.?/)[p]){var c=void 0===/()??/.exec("")[1];r=function(e,t){var a=String(this);if(void 0===e&&0===t)return[];if(!s(e))return i.call(a,e,t);var r,n,l,u,h,m=[],v=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),g=0,f=void 0===t?4294967295:t>>>0,w=new RegExp(e.source,v+"g");c||(r=new RegExp("^"+w.source+"$(?!\\s)",v));while(n=w.exec(a)){if(l=n.index+n[0][p],l>g&&(m.push(a.slice(g,n.index)),!c&&n[p]>1&&n[0].replace(r,function(){for(h=1;h<arguments[p]-2;h++)void 0===arguments[h]&&(n[h]=void 0)}),n[p]>1&&n.index<a[p]&&o.apply(m,n.slice(1)),u=n[0][p],g=l,m[p]>=f))break;w[d]===n.index&&w[d]++}return g===a[p]?!u&&w.test("")||m.push(""):m.push(a.slice(g)),m[p]>f?m.slice(0,f):m}}else"0"[n](void 0,0)[p]&&(r=function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)});return[function(a,s){var i=e(this),o=void 0==a?void 0:a[t];return void 0!==o?o.call(a,i,s):r.call(String(i),a,s)},r]})},"640f":function(e,t,a){},a55b:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login"},[a("div",{staticClass:"wrapper"},[a("h3",[e._v("Login")]),a("div",{staticClass:"logo-login"}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.appUpdater.isLatest,expression:"appUpdater.isLatest"}]},[a("font-awesome-icon",{attrs:{icon:"user"}}),a("mt-field",{staticClass:"user-id",attrs:{placeholder:"User Id",type:"text"},model:{value:e.userId,callback:function(t){e.userId=t},expression:"userId"}}),a("font-awesome-icon",{attrs:{icon:"key"}}),a("mt-field",{attrs:{placeholder:"Password",type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("mt-button",{attrs:{type:"primary",size:"large"},on:{click:e.onLogin}},[e._v("Login("+e._s(e.appUpdater.version)+")")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.appUpdater.isLatest,expression:"!appUpdater.isLatest"}]},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.appUpdater.isAndroid,expression:"appUpdater.isAndroid"}],staticStyle:{"text-align":"center",color:"white"}},[a("mt-button",{directives:[{name:"show",rawName:"v-show",value:e.appUpdater.updateError,expression:"appUpdater.updateError"}],attrs:{type:"primary",size:"large"},on:{click:e.updateApp}},[e._v("Retry update again")]),a("h5",{directives:[{name:"show",rawName:"v-show",value:!e.appUpdater.updateError,expression:"!appUpdater.updateError"}],staticStyle:{"margin-bottom":"0"}},[e._v(e._s(e.appUpdater.updateTitle))]),a("mt-progress",{attrs:{value:e.appUpdater.downloadProcessValue,"bar-height":5}},[a("div",{attrs:{slot:"start"},slot:"start"},[e._v("0%")]),a("div",{attrs:{slot:"end"},slot:"end"},[e._v(e._s(e.appUpdater.downloadProcessValue)+"%")])])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.appUpdater.isAndroid,expression:"!appUpdater.isAndroid"}],staticStyle:{"text-align":"center",color:"white"}},[a("h5",{staticStyle:{"margin-bottom":"0"}},[e._v(e._s(e.appUpdater.updateTitle))]),a("mt-progress",{attrs:{value:e.appUpdater.downloadProcessValue,"bar-height":5}},[a("div",{attrs:{slot:"start"},slot:"start"},[e._v("0%")]),a("div",{attrs:{slot:"end"},slot:"end"},[e._v(e._s(e.appUpdater.downloadProcessValue)+"%")])])],1)])])])},s=[],i=(a("aef6"),a("28a5"),a("6b54"),a("cadf"),a("551c"),a("097d"),a("bc3a")),o=a.n(i),n=a("ed08"),p=a("ac02"),d={name:"Login",data:function(){return{userId:"",password:"",appUpdater:{isLatest:!1,isAndroid:!1,updateTitle:"Checking new version ...",updateBaseUrl:"https://rciupdatetest.azurewebsites.net/RCAppsHome",appName:"RCHub",version:"2.1.0",downloadProcessValue:0,updateError:!1}}},methods:{login:function(e,t,a){var r=this,s="",i=t;0==a.length&&(a=n["a"].getTicks().toString(),i=n["a"].encryptPassword(a,t)),this.$showLoading(),p["a"].Login(e,i,a,s).then(function(o){if(o.data.OK){r.$closeLoading(),n["a"].setRemeberMe(e,i,a);var d=n["a"].getJobNumber(),c=o.data.Result,l={UsrAccountPK:c.UsrAccountPK,FirstName:c.FirstName,LastName:c.LastName,CurrentDateTime:c.CurrentDateTime,MinDateTime:c.MinDateTime,MaxDateTime:c.MaxDateTime,IsCompanyManager:c.IsCompanyManager,IsDivisionManager:c.IsDivisionManager,IsRegionManager:c.IsRegionManager,IsJobManager:c.IsJobManager,SearchJobNumber:d,SearchDateTime:c.CurrentDateTime,SearchRegionPK:"",SearchRegionName:""};n["a"].setUserToken(e,i,a,""),d?(n["a"].setUserSettings(l),r.$router.push({name:"JobTimesheetList"})):r.$prompt("Please input job number").then(function(e){var t=e.value,a=e.action;console.log(a),n["a"].setJobNumber(t),l.SearchJobNumber=t,n["a"].setUserSettings(l),r.$router.push({name:"JobTimesheetList"})}).catch(function(e){console.log(e),n["a"].setUserSettings(l),r.$router.push({name:"JobTimesheetList"})})}else p["a"].LoginByEmployee("","","",e,t,s).then(function(s){if(r.$closeLoading(),s.data.OK){n["a"].setRemeberMe(e,t,a);var i=s.data.Result,o={IsEmployee:!0,HREmployeePK:i.HREmployeePK,FirstName:i.FirstName,LastName:i.LastName,CurrentDateTime:i.CurrentDateTime,MinDateTime:i.MinDateTime,MaxDateTime:i.MaxDateTime};n["a"].setUserToken(i.UserId,i.Password,i.Ticks,i.Secret),n["a"].setUserSettings(o),r.$router.push({name:"EmployeeTimesheetList"})}else r.$message({message:s.data.Error,type:"error"}),console.log(s.data.Error)}).catch(function(e){r.$closeLoading(),r.showNetworkError(),console.log(e)})}).catch(function(e){r.$closeLoading(),r.showNetworkError(),console.log(e)})},checkUserInput:function(){return this.userId?!!this.password||(this.$alert("The password can not be empty.","Warning"),!1):(this.$alert("The user id can not be empty.","Warning"),!1)},onLogin:function(){this.checkUserInput()&&this.login(this.userId,this.password,"")},autoLogin:function(){var e=n["a"].getRemeberMe();e.UserId.length>0&&(this.userId=e.userId,this.login(e.UserId,e.Password,e.Ticks))},checkVersion:function(e){var t=this;"Android"===device.platform?this.appUpdater.isAndroid=!0:this.appUpdater.isAndroid=!1,this.appUpdater.isAndroid?this.checkAndroidVersion(function(a){a?t.updateApp():e()}):this.checkIOSVersion(function(a){a?t.updateApp():e()})},checkAndroidVersion:function(e){var t=this,a="".concat(this.appUpdater.updateBaseUrl,"/").concat(this.appUpdater.appName,"/").concat(this.appUpdater.appName,".txt");o.a.get(a).then(function(a){var r=a.data.Version;r!=t.appUpdater.version?(t.appUpdater.updateTitle="Downloading new version...",e(!0)):e(!1)}).catch(function(e){t.$alert(e)})},checkIOSVersion:function(e){var t=this,a="".concat(this.appUpdater.updateBaseUrl,"/").concat(this.appUpdater.appName,"/").concat(this.appUpdater.appName,".plist");o.a.get(a).then(function(a){for(var r="",s=a.data.split(/\r\n|[\r\n]/),i=0;i<s.length;i++){var o=s[i];if(o.endsWith("<key>bundle-version</key>")&&i+1<s.length){var n=s[i+1].indexOf("<string>");r=s[i+1].substring(n+8,n+8+5)}}r.length>0&&r!=t.appUpdater.version?(t.appUpdater.updateTitle="Updating the App, please wait...",e(!0)):e(!1)}).catch(function(e){t.$alert(e)})},updateApp:function(){if(this.appUpdater.isAndroid){var e=(new Date).getTime(),t="".concat(this.appUpdater.updateBaseUrl,"/").concat(this.appUpdater.appName,"/").concat(this.appUpdater.appName,".apk?v=").concat(e);this.updateAndroid(t)}else{var a="itms-services://?action=download-manifest&url=".concat(this.appUpdater.updateBaseUrl,"/").concat(this.appUpdater.appName,"/").concat(this.appUpdater.appName,".plist");this.updateIOS(a)}},updateAndroid:function(e){this.appUpdater.updateError=!1,this.appUpdater.downloadProcessValue=0;var t=this;try{window.resolveLocalFileSystemURL(cordova.file.externalDataDirectory,function(a){a.getFile("".concat(t.appUpdater.appName,".apk"),{create:!0,exclusive:!1},function(a){o()({method:"GET",url:e,responseType:"blob",onDownloadProgress:function(e){e.lengthComputable&&t.$nextTick(function(){t.appUpdater.downloadProcessValue=Math.round(e.loaded/e.total*100)})}}).then(function(e){var t=new Blob([e.data],{type:"application/vnd.android.package-archive"});a.createWriter(function(e){e.onwriteend=function(){cordova.plugins.fileOpener2.open(a.toInternalURL(),"application/vnd.android.package-archive")},e.write(t)})}).catch(function(e){alert("download error: "+e),t.appUpdater.updateError=!0})},function(e){alert("error getting file! "+e),t.appUpdater.updateError=!0})},function(e){alert("error getting persistent fs! "+e),t.appUpdater.updateError=!0})}catch(a){alert(a),t.appUpdater.updateError=!0}},updateIOS:function(e){cordova.InAppBrowser.open(e,"_system","location=no"),this.simulateDownloadIOS()},simulateDownloadIOS:function(){var e=this;setTimeout(function(){e.appUpdater.downloadProcessValue>=100?cordova.plugins.exit():(e.$nextTick(function(){e.appUpdater.downloadProcessValue+=20}),e.simulateDownloadIOS())},1e3)}},mounted:function(){var e=this;this.$cordova?this.checkVersion(function(){e.appUpdater.isLatest=!0,e.autoLogin()}):(this.appUpdater.isLatest=!0,this.autoLogin())}},c=d,l=(a("b53f"),a("dac8"),a("2877")),u=Object(l["a"])(c,r,s,!1,null,"ded8e74c",null);u.options.__file="Login.vue";t["default"]=u.exports},b53f:function(e,t,a){"use strict";var r=a("fb9b"),s=a.n(r);s.a},dac8:function(e,t,a){"use strict";var r=a("640f"),s=a.n(r);s.a},fb9b:function(e,t,a){}}]);
//# sourceMappingURL=Login.e0ee3296.js.map